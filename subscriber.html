<!DOCTYPE html>
<html>

<head>
    <title>Air Quality Index Subscriber</title>
</head>

<body>
    <div id="AQIIndex"></div>

    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.20.1.js"></script>

    <script type="text/javascript">
        var pubnub = new PubNub({
            subscribeKey: 'sub-c-ce1f7efa-0bda-11e8-8ffb-b29a975517c3'
        });
        
        pubnub.addListener({
            status: function(statusEvent) {
                if (statusEvent.category === "PNConnectedCategory") {
                    var payload = {
                        my: 'payload'
                    };
                } else if (statusEvent.category === "PNUnknownCategory") {
                    var newState = {
                        new: 'error'
                    };
                    pubnub.setState(
                        {
                            state: newState 
                        },
                        function (status) {
                            console.log(statusEvent.errorData.message)
                        }
                    );
                } 
            },
            message: function(message) {
                var str = JSON.stringify(message.message)
                document.write(str)
                console.log(message);
            }
        })
        pubnub.subscribe({ 
            channels: ['aqi'] 
        });
        


    </script>
    
</body>
</html>